! parse
stderr 'The function passed to `pubsub.NewSubscription` must be declared in the same service. Currently the function is not declared within a service.'

-- svc/svc.go --
package svc

import (
    "context"

    "test/shared"

    "encore.dev/pubsub"
)

type MessageType struct {
    Name string
}

var (
    BasicTopic = pubsub.NewTopic[*MessageType]("basic-topic")
    _ = pubsub.NewSubscription(BasicTopic, "basic-subscription", shared.Subscriber)
)

// encore:api
func DoStuff(ctx context.Context) error {
    return BasicTopic.Publish(ctx, &MessageType{Name: "foo"})
}

-- shared/shared.go --
package shared

func Subscriber(ctx context.Context, msg *shared.MessageType) error {
    return nil
}
