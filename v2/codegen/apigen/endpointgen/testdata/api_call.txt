-- svca/svca.go --
package svca

import "context"

//encore:api public
func Foo(ctx context.Context) error { return nil }

//encore:api public
func Bar(ctx context.Context) error { return Foo(ctx) }
-- svcb/svcb.go --
package svcb

import ("context"; "example.com/svca")

//encore:api public
func Baz(ctx context.Context) error { return svca.Foo(ctx) }
-- want:clients/svca/encore.gen.go --
// Code generated by encore. DO NOT EDIT.

package svcaclient

import (
	"context"
	__api "encore.dev/appruntime/apisdk/api"
	errs "encore.dev/beta/errs"
	jsoniter "github.com/json-iterator/go"
	"net/http"
	"net/url"
)

func Foo(ctx context.Context) error {
	callCtx := __api.NewCallContext(ctx)
	req := new(EncoreInternal_FooReq)
	_, err := EncoreInternal_svcaclient_api_APIDesc_Foo.Call(callCtx, req)
	return err
}

func Bar(ctx context.Context) error {
	callCtx := __api.NewCallContext(ctx)
	req := new(EncoreInternal_BarReq)
	_, err := EncoreInternal_svcaclient_api_APIDesc_Bar.Call(callCtx, req)
	return err
}

// Interface defines the service's API surface area, primarily for mocking purposes.
//
// Raw endpoints are currently excluded from this interface, as Encore does not yet
// support service-to-service API calls to raw endpoints.
type Interface interface {
	Foo(ctx context.Context) error

	Bar(ctx context.Context) error
}

type EncoreInternal_FooReq struct{}

type EncoreInternal_FooResp = __api.Void

type EncoreInternal_BarReq struct{}

type EncoreInternal_BarResp = __api.Void

var EncoreInternal_svcaclient_api_APIDesc_Foo = &__api.Desc[*EncoreInternal_FooReq, EncoreInternal_FooResp]{
	Access: __api.Public,
	AppHandler: func(ctx context.Context, reqData *EncoreInternal_FooReq) (EncoreInternal_FooResp, error) {
		handlerOpt := __api.LookupEndpoint("svca", "Foo")
		handler, found := handlerOpt.Get()
		if !found {
			return __api.Void{}, errs.B().Code(errs.NotFound).Msgf("endpoint %s.%s not found", "svca", "Foo").Err()
		}
		// Cast handler to *Desc to access AppHandler
		desc := handler.(*__api.Desc[*EncoreInternal_FooReq, EncoreInternal_FooResp])
		if desc.AppHandler == nil {
			return __api.Void{}, errs.B().Code(errs.Unimplemented).Msgf("endpoint %s.%s has no AppHandler", "svca", "Foo").Err()
		}
		_, err := desc.AppHandler(ctx, reqData)
		return __api.Void{}, err
	},
	CloneReq: func(r *EncoreInternal_FooReq) (*EncoreInternal_FooReq, error) {
		var clone *EncoreInternal_FooReq
		bytes, err := jsoniter.ConfigDefault.Marshal(r)
		if err == nil {
			err = jsoniter.ConfigDefault.Unmarshal(bytes, &clone)
		}
		return clone, err
	},
	CloneResp: nil,
	DecodeExternalResp: func(httpResp *http.Response, json jsoniter.API) (resp EncoreInternal_FooResp, err error) {
		return resp, nil
	},
	DecodeReq: func(httpReq *http.Request, ps __api.UnnamedParams, json jsoniter.API) (reqData *EncoreInternal_FooReq, pathParams __api.UnnamedParams, err error) {
		reqData = new(EncoreInternal_FooReq)
		return reqData, nil, nil
	},
	DefLoc: uint32(0x0),
	EncodeExternalReq: func(reqData *EncoreInternal_FooReq, stream *jsoniter.Stream) (httpHeader http.Header, queryString url.Values, err error) {
		return nil, nil, nil
	},
	EncodeResp: func(w http.ResponseWriter, json jsoniter.API, resp EncoreInternal_FooResp, status int) (err error) {
		return nil
	},
	Endpoint:            "Foo",
	Fallback:            false,
	GlobalMiddlewareIDs: nil,
	Methods:             []string{"GET", "POST"},
	Path:                "/svca.Foo",
	PathParamNames:      nil,
	Raw:                 false,
	RawHandler:          nil,
	RawPath:             "/svca.Foo",
	ReqPath: func(reqData *EncoreInternal_FooReq) (string, __api.UnnamedParams, error) {
		return "/svca.Foo", nil, nil
	},
	ReqUserPayload: func(reqData *EncoreInternal_FooReq) any {
		return nil
	},
	Service:           "svca",
	ServiceMiddleware: nil,
	SvcNum:            1,
	Tags:              nil,
}

var EncoreInternal_svcaclient_api_APIDesc_Bar = &__api.Desc[*EncoreInternal_BarReq, EncoreInternal_BarResp]{
	Access: __api.Public,
	AppHandler: func(ctx context.Context, reqData *EncoreInternal_BarReq) (EncoreInternal_BarResp, error) {
		handlerOpt := __api.LookupEndpoint("svca", "Bar")
		handler, found := handlerOpt.Get()
		if !found {
			return __api.Void{}, errs.B().Code(errs.NotFound).Msgf("endpoint %s.%s not found", "svca", "Bar").Err()
		}
		// Cast handler to *Desc to access AppHandler
		desc := handler.(*__api.Desc[*EncoreInternal_BarReq, EncoreInternal_BarResp])
		if desc.AppHandler == nil {
			return __api.Void{}, errs.B().Code(errs.Unimplemented).Msgf("endpoint %s.%s has no AppHandler", "svca", "Bar").Err()
		}
		_, err := desc.AppHandler(ctx, reqData)
		return __api.Void{}, err
	},
	CloneReq: func(r *EncoreInternal_BarReq) (*EncoreInternal_BarReq, error) {
		var clone *EncoreInternal_BarReq
		bytes, err := jsoniter.ConfigDefault.Marshal(r)
		if err == nil {
			err = jsoniter.ConfigDefault.Unmarshal(bytes, &clone)
		}
		return clone, err
	},
	CloneResp: nil,
	DecodeExternalResp: func(httpResp *http.Response, json jsoniter.API) (resp EncoreInternal_BarResp, err error) {
		return resp, nil
	},
	DecodeReq: func(httpReq *http.Request, ps __api.UnnamedParams, json jsoniter.API) (reqData *EncoreInternal_BarReq, pathParams __api.UnnamedParams, err error) {
		reqData = new(EncoreInternal_BarReq)
		return reqData, nil, nil
	},
	DefLoc: uint32(0x0),
	EncodeExternalReq: func(reqData *EncoreInternal_BarReq, stream *jsoniter.Stream) (httpHeader http.Header, queryString url.Values, err error) {
		return nil, nil, nil
	},
	EncodeResp: func(w http.ResponseWriter, json jsoniter.API, resp EncoreInternal_BarResp, status int) (err error) {
		return nil
	},
	Endpoint:            "Bar",
	Fallback:            false,
	GlobalMiddlewareIDs: nil,
	Methods:             []string{"GET", "POST"},
	Path:                "/svca.Bar",
	PathParamNames:      nil,
	Raw:                 false,
	RawHandler:          nil,
	RawPath:             "/svca.Bar",
	ReqPath: func(reqData *EncoreInternal_BarReq) (string, __api.UnnamedParams, error) {
		return "/svca.Bar", nil, nil
	},
	ReqUserPayload: func(reqData *EncoreInternal_BarReq) any {
		return nil
	},
	Service:           "svca",
	ServiceMiddleware: nil,
	SvcNum:            1,
	Tags:              nil,
}
-- want:svca/encore.gen.go --
// Code generated by encore. DO NOT EDIT.

package svca

import "context"

// These functions are automatically generated and maintained by Encore
// to simplify calling them from other services, as they were implemented as methods.
// They are automatically updated by Encore whenever your API endpoints change.

// Interface defines the service's API surface area, primarily for mocking purposes.
//
// Raw endpoints are currently excluded from this interface, as Encore does not yet
// support service-to-service API calls to raw endpoints.
type Interface interface {
	Foo(ctx context.Context) error

	Bar(ctx context.Context) error
}
-- want:svca/encore_internal__api.go --
package svca

import (
	__api "encore.dev/appruntime/apisdk/api"
	svca "example.com/clients/svca"
)

func init() {
	__api.RegisterEndpoint(EncoreInternal_api_APIDesc_Foo, "Foo")
	__api.RegisterEndpoint(EncoreInternal_api_APIDesc_Bar, "Bar")
}

var EncoreInternal_api_APIDesc_Foo = &svca.EncoreInternal_svcaclient_api_APIDesc_Foo

var EncoreInternal_api_APIDesc_Bar = &svca.EncoreInternal_svcaclient_api_APIDesc_Bar
-- want:svca/encore_internal__apicalls.go --
package svca

import (
	"context"
	__api "encore.dev/appruntime/apisdk/api"
)

func EncoreInternal_apicalls_Foo(ctx context.Context) error {
	_, err := EncoreInternal_api_APIDesc_Foo.Call(__api.NewCallContext(ctx), &EncoreInternal_FooReq{})
	if err != nil {
		return err
	}
	return nil
}
-- want:svca/svca.go --
package svca

import "context"

//encore:api public
func Foo(ctx context.Context) error { return nil }

//encore:api public
func Bar(ctx context.Context) error { return EncoreInternal_apicalls_Foo(ctx) }
-- want:svcb/svcb.go --
package svcb

import ("context"; "example.com/svca")

//encore:api public
func Baz(ctx context.Context) error { return svca.EncoreInternal_apicalls_Foo(ctx) }
